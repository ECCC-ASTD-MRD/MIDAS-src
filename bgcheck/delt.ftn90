SUBROUTINE  DELT  ( DEL, SCOS )
!***subroutine     DELT
!*
!*auteur           Louis Garand  - rpn - dorval
!*
!*revision 001     Jacques Halle - ddo - dorval - 421-4660
!*                                 fev 1991
!*                 adapter au systeme operationel GOES.
!*
!*REVISION 002     JACQUES HALLE - DDO - DORVAL - 421-4660
!*                                 Decembre 1995
!*                 Generaliser pour toutes les plateformes satellitaires.
!*
!*objet            ce sous-programme calcule un facteur de correction
!*                 pour l'albedo a partir du cosinus de l'angle solaire. 
!*
!*appel            CALL DELT  ( DEL, SCOS )
!*
!*arguments        del   - output - facteur de correction
!*                 scos  - input  - cosinus de l'angle solaire
!**
  implicit  none
  real,intent(in)  ::  scos
  real,intent(out) ::  del
!************************************
  integer  i1, i2
  real  pi, fac, x1, x2, g1, g2, a, b
  real ,external :: drcld
  real  S(11)
 
  DATA  S / 00.00, 18.19, 31.79, 41.41, 49.46, 56.63, 63.26, 69.51, 75.52, 81.37, 87.13 /
 
  PI  = 3.14159265 
  FAC = PI/180. 
  I1  = 12 -( SCOS+0.05)*10. 
  I2  = I1+1 
  I1  = MIN0(I1,11)
  I2  = MIN0(I2,11)
  X1  = COS ( S(I1)*FAC )  
  X2  = COS ( S(I2)*FAC ) 
  G1  = DRCLD(I1)
  G2  = DRCLD(I2)
  if (I1==I2) then
     DEL =G1
  else
     CALL  SOLU ( G1, X1, G2 ,X2, A, B )
     DEL = A*SCOS + B
  endif
  
  RETURN

contains

SUBROUTINE  SOLU ( YY1, XX1, YY2, XX2, AA, BB )
!**subroutine     SOLU
!
!auteur           Louis Garand  - rpn - dorval
!
!revision 001     Jacques Halle - ddo - dorval - 421-4660
!                                 fev 1991
!                 adapter au systeme operationel GOES.
!
!REVISION 002     JACQUES HALLE - DDO - DORVAL - 421-4660
!                                 Decembre 1995
!                 Generaliser pour toutes les plateformes satellitaires.
!
!langage          fortran 5
!
!objet            ce sous-programme calcule la pente et l'intercept
!                 a partir de deux couples de donnees.
!
!appel            CALL SOLU ( Y1, X1, Y2, X2, A, B )
!
!arguments        XY1    - input - coordonnee Y du point 1
!                 XX1    - input - coordonnee X du point 1
!                 YY2    - input - coordonnee Y du point 2
!                 YX2    - input - coordonnee X du point 2
!                 AA     - output- pente
!                 BB     - output- intercept
!*
  real,intent (in)  ::  YY1, XX1, YY2, XX2
  real,intent (out) ::  AA, BB
! 
!  DROITE PASSANT PAR DEUX POINTS PENTE A ET INTERCEPT B
!


  AA = (YY1-YY2)/(XX1-XX2)
  BB = YY1 - A*XX1

  RETURN 
END SUBROUTINE SOLU


END SUBROUTINE DELT
